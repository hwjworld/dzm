{% extends "base_generic.html" %}
{% load staticfiles %}

{% block jsextra %}
<script src="{% static "js/l.js" %}"></script>
<script language="javascript">
 var data_info = [
 {% if records|length > 0 %}
  {% for  v in records %}
  [{{ v.householder.map_x }},{{ v.householder.map_y }}],
  {% endfor %}
{% endif %}
];
$(document).ready(function(){addMarkPoints(data_info);});

</script>
{% endblock %}

{% block record_form %}
        <form id="searchform">
            <table>
                <tr><td>开始日期</td><td><input type="text" id="start_date" readOnly="true" /></td>
                <td>结束日期</td><td><input type="text" id="end_date" readOnly="true"/></td>
                 <td><input type="button" onclick="seachform_submit()" value="查看记录"/></td>&nbsp;
                 <td><input type="button" onclick="thismonth_submit()" value="  本月  "/></td>&nbsp;
                 <td><input type="button" onclick="lastmonth_submit()" value="  上月  "/></td>&nbsp;
                </tr>

            </table>
        </form>
        <table border="1" width="100%">
            <tr><td>日期</td><td>姓名</td><td>性别</td><td>胡同(街)</td><td>门牌</td><td>反应</td><td>义工</td></tr>
{% if records|length > 0 %}
  {% for  v in records %}
    <tr name="recordtr" id="record-{{ v.id }}" mapx="{{ v.householder.map_x }}" mapy="{{ v.householder.map_y }}">
        <td>{{v.visit_date|date:"Y-m-d D"}}</td>
        <td>{{v.householder.name}}</td>
        <td>{% ifequal v.householder.sex "1" %}男{% endifequal %}{% ifequal v.householder.sex "0" %}女{% endifequal %}{% ifequal v.householder.sex "2" %}其他{% endifequal %}</td>
        <td>{{v.householder.street}}</td>
        <td>{{v.householder.num}}</td>
        <td>{% ifequal v.householder.response "1" %}续访{% endifequal %}{% ifequal v.householder.response "0" %}拒绝{% endifequal %}</td>
        <td>{{v.volunteer}}</td>
    </tr>
  {% endfor %}
{% else %}
<tr><td colspan="6">要多多做工作</tr>
{% endif %}
        </table>
        <br/>
        <table border="1" width="50%">
        <tr><td>接受</td><td>拒绝</td></tr>
        <tr><td>{{ rs_sum.a }}人</td><td>{{ rs_sum.r }}人</td></tr>
        </table>
{% endblock %}